SUBROUTINE ADDDATE(IDATE1,IADD,IDATE2)

USE TIMEFINC

IMPLICIT NONE

INTEGER, INTENT(IN) :: IDATE1(6), IADD(6)
INTEGER, INTENT(OUT) :: IDATE2(6)
INTEGER :: IREST,JDAY,IDAUX

!... SECONDS
IDATE2(6) = IDATE1(6) + IADD(6)
IREST=0
IF(IDATE2(6) .GE. 60) THEN
          IREST=INT(IDATE2(6)/60)
          IDATE2(6)=MOD(IDATE2(6),60)
ENDIF
!... MINUTES
IDATE2(5) = IDATE1(5) + IADD(5) + IREST
IREST=0
IF(IDATE2(5) .GE. 60) THEN
          IREST=INT(IDATE2(5)/60)
          IDATE2(5)=MOD(IDATE2(5),60)
ENDIF
!... HOURS
IDATE2(4) = IDATE1(4) + IADD(4) + IREST
IREST=0
IF(IDATE2(5) .GE. 24) THEN
          IREST=INT(IDATE2(4)/24)
          IDATE2(4)=MOD(IDATE2(4),60)
ENDIF
!... DAYS
IF(IREST+IADD(3).GE.1) THEN
   IDAUX=IDATE1(1)*10000 + IDATE1(2)*100 + IDATE1(3)
   DO JDAY=1,IREST+IADD(3)
          CALL PLUSDAY(IDAUX)
   ENDDO
   IDATE2(1) = INT(IDAUX/10000)
   IDATE2(2) = INT(MOD(IDAUX,10000)/100)
   IDATE2(3) = IDAUX - ( IDATE2(1)*10000 + IDATE2(2)*100 )
ELSEIF(IREST+IADD(3).LT.1) THEN
   IDAUX=IDATE1(1)*10000 + IDATE1(2)*100 + IDATE1(3)
   DO JDAY=1,-1*(IREST+IADD(3))
          CALL MINUSDAY(IDAUX)
   ENDDO
   IDATE2(1) = INT(IDAUX/10000)
   IDATE2(2) = INT(MOD(IDAUX,10000)/100)
   IDATE2(3) = IDAUX - ( IDATE2(1)*10000 + IDATE2(2)*100 )
ELSE
   IDATE2(1)=IDATE1(1)
   IDATE2(2)=IDATE1(2)
   IDATE2(3)=IDATE1(3)
ENDIF

END SUBROUTINE ADDDATE
